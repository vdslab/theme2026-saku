# Project Brief: トーラス階層割当システム

## プロジェクト概要

トーラスを含む階層グラフの階層割当を数理最適化によって実現するシステム。

## 主要目標

1. **トーラス辺の自動判定**: 階層が減少する辺（トーラス辺）を自動的に識別
2. **階層数の最適化**: 最適な階層数を変数として自動決定
3. **DAG対応**: DAGの場合は極力トーラス辺を使用しない
4. **可視化**: トーラス辺を含むグラフの視覚的表現

## スコープ

### 含まれるもの

- 数理計画問題としての定式化（Gurobi使用）
- Big-M法によるトーラス辺の判定
- 階層グラフの描画機能
- 多様なグラフ構造への対応（DAG、サイクリック、混合）
- 包括的なテストスイート

### 含まれないもの

- リアルタイム最適化
- 大規模グラフ（数千ノード以上）の高速処理
- 対話的な編集機能

## 主要制約

1. すべてのノードは入次数>0かつ出次数>0（完全ループ構造）
2. 階層の方向に逆らう辺（逆辺）はトーラスで処理
3. 各サイクルで1回だけトーラスを使用

## 成功基準

- ✅ 22件のテストケースで100%成功
- ✅ DAGでトーラス辺数0
- ✅ サイクルを含むグラフで必要最小限のトーラス辺
- ✅ 完全な数理モデルドキュメント
